<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="refresh" content="600" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clima PUC</title>
    <link
      rel="icon"
      href="{{ url_for('static', filename='clima.png') }}"
      type="image/png"
    />
    <!-- Pré-conexão para otimizar carregamento de ícones e fontes -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* RESET */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Roboto", sans-serif;
        background: #1f2a44;
        color: #fff;
        position: relative;
        min-height: 100vh;
      }
      /* SIDEBAR */
      .sidebar {
        position: fixed;
        width: 80px;
        height: 100vh;
        background-color: #2a3550;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px 0;
        transition: transform 0.2s ease-in-out;
        z-index: 1000;
      }
      .sidebar.hide {
        transform: translateX(-100%);
      }
      .sidebar img {
        width: 80px;
        margin-bottom: 30px;
      }
      .sidebar .nav-item {
        margin: 20px 0;
        cursor: pointer;
        color: #fff;
      }
      .sidebar .nav-item a {
        color: inherit;
        text-decoration: none;
      }
      .sidebar .nav-item i {
        font-size: 1.8em;
      }
      .sidebar-toggle {
        display: flex;
        align-items: center;
        gap: 5px;
        margin-bottom: 20px;
      }
      .sidebar-toggle span {
        font-size: 1em;
      }
      .sidebar-toggle label {
        display: flex;
        align-items: center;
        cursor: pointer;
      }
      .sidebar-toggle .slider {
        width: 40px;
        height: 20px;
        background-color: #ccc;
        border-radius: 25px;
        position: relative;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .sidebar-toggle .slider:before {
        content: "";
        position: absolute;
        width: 16px;
        height: 16px;
        background-color: #fff;
        border-radius: 50%;
        top: 2px;
        left: 2px;
        transition: transform 0.2s;
      }
      input[type="checkbox"] {
        display: none;
      }
      input[type="checkbox"]:checked + .slider {
        background-color: #02d7fd;
      }
      input[type="checkbox"]:checked + .slider:before {
        transform: translateX(25px);
      }
      /* CONTEÚDO PRINCIPAL */
      .main-content {
        margin-left: 80px;
        padding: 20px;
        transition: margin-left 0.3s ease-in-out;
      }
      .top-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        margin-bottom: 10px 20px;
      }
      .top-bar h1 {
        font-size: 4em;
        text-align: center;
        margin: 0;
        flex-grow: 1;
      }
      .menu-btn {
        background: none;
        border: none;
        color: #fff;
        font-size: 2em;
        cursor: pointer;
        margin-left: 10px;
      }
      /* CARD DE CLIMA ATUAL */
      .current-weather {
        background-color: #2f3b58;
        border-radius: 20px;
        padding: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
      }
      .weather-info {
        display: flex;
        flex-direction: column;
      }
      .weather-info h2 {
        font-size: 9em;
      }
      .weather-info p {
        font-size: 1.6em;
        margin-top: 10px;
      }
      .weather-icon {
        font-size: 7em;
      }
      /* BOX UNIFICADA DE CONDIÇÕES */
      .conditions-box {
        background-color: #2f3b58;
        border-radius: 15px;
        padding: 50px;
        width: 100%;
        max-width: 2000px;
        margin: 0 auto 30px;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-auto-rows: minmax(120px, auto);
        gap: 40px;
        text-align: center;
      }
      /* Centraliza o quinto item */
      .conditions-box .condition-item:nth-child(5) {
        grid-column: 1 / span 2;
      }
      .condition-item h3 {
        font-size: 3.2em;
        margin-bottom: 10px;
        color: #ffd700;
      }
      .condition-item p {
        font-size: 2.2em;
        margin-bottom: 5px;
      }
      .condition-item span {
        font-size: 1.4em;
        color: #ccc;
      }
      /* Seta para direção do vento */
      .arrow {
        display: inline-block;
        width: 0;
        height: 0;
        border-left: 20px solid transparent;
        border-right: 20px solid transparent;
        border-bottom: 40px solid #fff;
        margin: 10px auto;
        transform-origin: center;
      }
      .rotate-0 {
        transform: rotate(0deg);
      }
      .rotate-45 {
        transform: rotate(45deg);
      }
      .rotate-90 {
        transform: rotate(90deg);
      }
      .rotate-135 {
        transform: rotate(135deg);
      }
      .rotate-180 {
        transform: rotate(180deg);
      }
      .rotate-225 {
        transform: rotate(225deg);
      }
      .rotate-270 {
        transform: rotate(270deg);
      }
      .rotate-315 {
        transform: rotate(315deg);
      }
      /* RODAPÉ */
      .footer {
        text-align: center;
        margin-top: 20px;
        color: #ccc;
        font-size: 1.5em;
      }
      /* RESPONSIVIDADE */
      @media (max-width: 768px) {
        .top-bar h1 {
          font-size: 2.5em;
        }
        .current-weather h2 {
          font-size: 4em;
        }
        .condition-item h3 {
          font-size: 2em;
        }
        .condition-item p {
          font-size: 1.6em;
        }
      }
      .sidebar.hide + .main-content {
        margin-left: 0;
      }
    </style>
  </head>
  <body>
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <img
        src="{{ url_for('static', filename='loguinho.png') }}"
        alt="PUC Logo"
      />
      <!-- Toggle de temperatura na sidebar -->
      <div class="sidebar-toggle">
        <span>°C</span>
        <label>
          <input
            type="checkbox"
            id="toggleTemp"
            onclick="toggleTemperature()"
          />
          <span class="slider"></span>
        </label>
        <span>°F</span>
      </div>
      <div class="nav-item">
        <a href="/temperatura"><i class="fas fa-thermometer-4"></i></a>
      </div>
      <div class="nav-item">
        <a href="/dados"><i class="fas fa-magnifying-glass-plus"></i></a>
      </div>
    </aside>

    <!-- CONTEÚDO PRINCIPAL -->
    <div class="main-content" id="mainContent">
      <div class="top-bar">
        <button class="menu-btn" onclick="toggleSidebarVisibility()">
          <i class="fas fa-bars"></i>
        </button>
        <h1>Clima PUC</h1>
      </div>

      <!-- CARD DE CLIMA ATUAL -->
      <div class="current-weather">
        <div class="weather-info">
          <h2 class="temperature" data-temp="{{ temperature }}">
            {{ "%.f"|format(temperature) }}°C
          </h2>
          <p class="temperature-status">{{ temperature_status }}</p>
        </div>
        <div class="weather-icon">
          <i id="current-icon" class="{{ wind_icon_class }}"></i>
        </div>
      </div>

      <!-- BOX UNIFICADA DE CONDIÇÕES -->
      <div class="conditions-box">
        <!-- Umidade -->
        <div class="condition-item">
          <h3><i class="fas fa-tint"></i> Umidade</h3>
          <p>{{ "%.f"|format(humidity) }}%</p>
          <span>{{ humidity_status }}</span>
        </div>
        <!-- Chuva -->
        <div class="condition-item">
          <h3><i class="fas fa-cloud-showers-heavy"></i> Chuva</h3>
          <p>{{ "%.3f"|format(rain_level) }} mm</p>
          <span>{{ rain_status }}</span>
        </div>
        <!-- Velocidade do Vento -->
        <div class="condition-item">
          <h3><i class="fas fa-wind"></i> Velocidade do vento</h3>
          <p>{{ "%.2f"|format(wind_speed_kmh) }} km/h</p>
          <span>{{ wind_speed_status }}</span>
        </div>
        <!-- Direção do Vento -->
        <div class="condition-item">
          <h3> Direção do vento</h3>
          <p><div class="arrow {{ wind_icon_class }}"></div></p>
          <span>{{ wind_direction }}</span>
        </div>
        <!-- Radiação UV -->
        <div class="condition-item">
          <h3><i class="fas fa-sun"></i> Radiação UV</h3>
          <p>{{ "%.f"|format(uv_index) }}</p>
          <span>{{ uv_status }}</span>
        </div>
      </div>

      <!-- RODAPÉ -->
      <div class="footer">
        <p>
          Desenvolvido por alunos da <strong>PUC</strong>. Todos os direitos
          reservados.
        </p>
      </div>
    </div>

    <!-- SCRIPT PARA TOGGLE DE TEMPERATURA E SIDEBAR -->
    <script>
      function toggleTemperature() {
        const toggle = document.getElementById("toggleTemp");
        const tempElements = document.querySelectorAll(".temperature");
        tempElements.forEach((element) => {
          let originalTemp = parseFloat(element.getAttribute("data-temp")) || 0;
          let convertedTemp;
          if (toggle.checked) {
            // Converter Celsius para Fahrenheit
            convertedTemp = (originalTemp * 9) / 5 + 32;
            element.textContent = convertedTemp.toFixed(1) + " °F";
          } else {
            // Converter Fahrenheit para Celsius
            convertedTemp = ((originalTemp - 32) * 5) / 9;
            element.textContent = Math.round(convertedTemp) + " °C";
          }
          element.setAttribute("data-temp", convertedTemp.toFixed(1));
        });
      }
      function toggleSidebarVisibility() {
        const sidebar = document.getElementById("sidebar");
        const mainContent = document.getElementById("mainContent");
        sidebar.classList.toggle("hide");
        if (sidebar.classList.contains("hide")) {
          mainContent.style.marginLeft = "0";
        } else {
          mainContent.style.marginLeft = "80px";
        }
      }
    </script>
  </body>
</html>
